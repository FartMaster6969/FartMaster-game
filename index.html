<!DOCTYPE html>
<html>
<head>
    <title>Flappy Fart</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #1a1a1a;
            color: #fff;
            text-align: center;
            margin: 0;
            padding: 0;
            overflow: hidden;
        }
        #gameArea {
            position: relative;
            width: 800px; /* Större skärm */
            height: 600px;
            background: linear-gradient(#87ceeb, #e0f6ff); /* Himmelblå bakgrund */
            margin: 20px auto;
            border: 2px solid #fff;
            overflow: hidden;
            font-family: monospace; /* För pixelart */
        }
        #character {
            position: absolute;
            width: 34px; /* Flappy Bird-storlek */
            height: 24px;
            font-size: 8px;
            line-height: 8px;
            top: 50%;
            left: 100px; /* Startar längre in för reaktionstid */
            background: #ffff00; /* Gul som Flappy Bird */
            color: #000000; /* Svarta detaljer */
            text-align: center;
            padding: 2px;
            box-sizing: border-box;
            image-rendering: pixelated; /* Behåller pixelart */
            transition: top 0.1s ease-out; /* Smidig rörelse */
        }
        .fartCloud {
            position: absolute;
            font-size: 8px;
            bottom: -10px;
            left: 10px;
            opacity: 0;
            color: #ffffff;
            background: #808080; /* Grå moln */
            animation: floatUp 0.5s ease-out forwards; /* Kortare, snabbare animation */
        }
        @keyframes floatUp {
            0% { opacity: 1; bottom: -10px; transform: scale(1); }
            50% { transform: scale(1.1) rotate(10deg); }
            100% { opacity: 0; bottom: 20px; transform: scale(1); }
        }
        .obstacle {
            position: absolute;
            width: 52px; /* Större för Flappy Bird-stil */
            height: 400px; /* Högre hinder som i Flappy Bird */
            background: #008000; /* Grön som rör i Flappy Bird */
            right: 0;
            line-height: 50px;
            font-size: 8px;
            color: #000000; /* Svarta detaljer */
            text-align: center;
            padding: 2px;
            box-sizing: border-box;
            image-rendering: pixelated;
        }
        #score, #highScore, #message {
            font-size: 24px;
            margin: 10px;
        }
        #tokenInfo {
            font-size: 20px;
            margin: 10px;
        }
        #restartButton {
            display: none;
            padding: 15px 30px;
            font-size: 20px;
            background-color: #ff6600;
            border: none;
            border-radius: 5px;
            color: #fff;
            cursor: pointer;
            margin: 10px;
        }
        #restartButton:hover {
            background-color: #cc5200;
        }
        a { color: #00cc00; }
    </style>
</head>
<body>
    <h1>Flappy Fart</h1>
    <p id="score">FMC: 0</p>
    <p id="highScore">High Score: 0</p>
    <div id="gameArea">
        <div id="character">█<br>███<br>█</div> <!-- Flappy Bird-liknande fågel (gul) -->
    </div>
    <p id="message"></p>
    <p id="tokenInfo">FartMaster Coin (FMC) Address: <span id="tokenAddress">[Launching soon]</span></p>
    <p><a href="https://twitter.com/FartMasterCoin">Följ oss på Twitter för updates!</a></p>
    <button id="restartButton" onclick="restartGame()">Restart</button>

    <script>
        const gameArea = document.getElementById("gameArea");
        const character = document.getElementById("character");
        const scoreDisplay = document.getElementById("score");
        const highScoreDisplay = document.getElementById("highScore");
        const messageDisplay = document.getElementById("message");
        const tokenAddress = document.getElementById("tokenAddress");
        const restartButton = document.getElementById("restartButton");

        let score = 0;
        let characterY = 300; // Startposition i mitten (px)
        let gravity = 2;
        let baseJumpHeight = -50; // Högre hopp som i Flappy Bird
        let jumpBonus = 0; // Extra höjd per klick, ökar med 5 per hopp (max 30)
        let isGameOver = false; // Spelet startar direkt nu
        let obstacleSpeed = 3;
        let obstacleInterval;
        let difficultyIncrease = 0; // För progressiv svårighet

        // Ladda high score från localStorage
        let highScore = localStorage.getItem("flappyFartHighScore") || 0;
        highScoreDisplay.innerText = "High Score: " + highScore;

        // Placera karaktären och hantera hopp
        function updateCharacter() {
            if (!isGameOver) {
                characterY += gravity;
                if (characterY > 550) characterY = 550; // Håller fågeln ovanför botten (kan inte dö vid golv)
                if (characterY < 0) characterY = 0; // Hindra från att flyga över toppen
                character.style.top = characterY + "px";
            }
        }

        // Hoppa med mus eller mellanslag
        document.addEventListener("click", jump);
        document.addEventListener("keydown", (e) => {
            if (e.code === "Space" && !isGameOver) {
                jump();
            }
        });

        function jump() {
            if (!isGameOver) {
                // Öka hopphöjden lite per klick (max +30)
                jumpBonus = Math.min(jumpBonus + 5, 30);
                const totalJump = baseJumpHeight - jumpBonus; // Lägre värde = högre hopp
                characterY += totalJump;
                if (characterY < 0) characterY = 0; // Förhindra att gå över toppen
                showFartCloud(); // Visa gasmoln vid hopp
                jumpBonus = 0; // Återställ bonus efter hopp
            }
        }

        // Visa gasmoln vid hopp
        function showFartCloud() {
            const cloud = document.createElement("div");
            cloud.className = "fartCloud";
            cloud.innerText = "█"; // Enkel pixelart-fismoln
            character.appendChild(cloud);
            setTimeout(() => cloud.remove(), 500); // Ta bort efter 0.5 sekunder, snabbare som Flappy Bird
        }

        // Skapa hinder (rör) med progressiv svårighet
        function createObstacle() {
            if (!isGameOver) {
                const obstacle = document.createElement("div");
                obstacle.className = "obstacle";
                obstacle.innerText = "█\n█\n█\n█\n█\n█\n█\n█"; // Pixelart-rör (gröna hinder)
                obstacle.style.top = Math.random() * 300 + "px"; // Slumpmässig höjd, mindre utrymme för att matcha Flappy Bird
                // Lägg till bottenhinder med 20% chans efter 300 poäng
                if (Math.random() < 0.2 && score > 300) {
                    obstacle.style.top = "520px"; // Nära botten
                }
                gameArea.appendChild(obstacle);

                let obstacleX = 800; // Startar längre bort p.g.a. större skärm
                const currentSpeed = obstacleSpeed + difficultyIncrease; // Öka hastighet med svårighet
                const moveObstacle = setInterval(() => {
                    if (!isGameOver) {
                        obstacleX -= currentSpeed;
                        obstacle.style.right = (800 - obstacleX) + "px";
                        if (obstacleX < 34 && obstacleX > 0) { // Kollision med fågel (justerat för mindre bredd)
                            const obstacleRect = obstacle.getBoundingClientRect();
                            const characterRect = character.getBoundingClientRect();
                            if (characterRect.top < obstacleRect.bottom && characterRect.bottom > obstacleRect.top) {
                                gameOver();
                            }
                        }
                        if (obstacleX < -52) {
                            obstacle.remove();
                            score += 10;
                            scoreDisplay.innerText = "FMC: " + score;
                            difficultyIncrease = Math.min(difficultyIncrease + 0.2, 8); // Öka svårighet gradvis (max 8)
                            if (score > highScore) {
                                highScore = score;
                                localStorage.setItem("flappyFartHighScore", highScore);
                                highScoreDisplay.innerText = "High Score: " + highScore;
                            }
                            clearInterval(moveObstacle);
                        }
                    } else {
                        clearInterval(moveObstacle);
                    }
                }, 16); // Ca 60 FPS
            }
        }

        // Starta spelet automatiskt
        function startGame() {
            if (isGameOver) {
                score = 0;
                characterY = 300;
                jumpBonus = 0;
                isGameOver = false;
                difficultyIncrease = 0; // Återställ svårighet
                scoreDisplay.innerText = "FMC: 0";
                messageDisplay.innerText = "";
                restartButton.style.display = "none"; // Säkerställ att restart är gömd
                gameArea.innerHTML = '<div id="character">█<br>███<br>█</div>'; // Återställ pixelart-fågel
                character = document.getElementById("character");
                obstacleInterval = setInterval(createObstacle, 2000); // Nytt hinder var 2:a sekund
                setInterval(updateCharacter, 16); // Uppdatera position varje frame
            }
        }

        // Game over
        function gameOver() {
            isGameOver = true;
            clearInterval(obstacleInterval);
            messageDisplay.innerText = "Game Over! You collected " + score + " FMC.";
            restartButton.style.display = "block"; // Visa restart-knappen
        }

        // Restart spelet
        function restartGame() {
            score = 0;
            characterY = 300;
            jumpBonus = 0;
            difficultyIncrease = 0; // Återställ svårighet
            isGameOver = false;
            scoreDisplay.innerText = "FMC: 0";
            messageDisplay.innerText = "";
            restartButton.style.display = "none"; // Dölj restart-knappen
            gameArea.innerHTML = '<div id="character">█<br>███<br>█</div>'; // Återställ pixelart-fågel
            character = document.getElementById("character");
            startGame();
        }

        // Lägg till token-adress efter lansering
        function updateTokenAddress() {
            tokenAddress.innerText = "ABC123...xyz"; // Ersätt med din Pump.fun-adress
        }
        // Kör updateTokenAddress() efter lansering genom att ta bort kommentaren nedan
        // updateTokenAddress();

        // Starta spelet automatiskt när sidan laddas
        window.onload = () => {
            startGame(); // Spelet startar direkt, ingen startknapp
        };
    </script>
</body>
</html>